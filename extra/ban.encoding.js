// Redirect search to d3search.ru
d3.addModule(
{
	type: "Содержание",
	name: 'Фикс кодировки бан-блога',
	author: 'crimaniak',
	config: {active:{type:'checkbox',value:true}},
	table:	// table taken from Dirty Service Pack
		{'Ð»Ð¾Ð¿Ð°ÑÐ¾Ð¹':'лопатой',
		'Ð´Ð¾':'до',
		'Ð·Ð°':'за',
		'ÐÑÐ½Ñ':'Июня',
		'ÐÐ°Ñ':'Мая',
		'ÐÐ¿ÑÐµÐ»Ñ':'Апреля',
		'ÐÐ°ÑÑÐ°':'Марта',
		'Ð¤ÐµÐ²ÑÐ°Ð»Ñ':'Февраля',
		'Ð¯Ð½Ð²Ð°ÑÑ':'Января',
		'ÐÐµÐºÐ°Ð±ÑÑ':'Декабря',
		'ÐÐºÑÑÐ±ÑÑ':'Октября',
		'ÐÐ¾ÑÐ±ÑÑ':'Ноября',
		'Ð¡ÐµÐ½ÑÑÐ±ÑÑ':'Сентября',
		'ÐÐ²Ð³ÑÑÑÐ°':'Августа',
		'ÐÑÐ»Ñ':'Июля',
		'ÐÐ¾':'Во',
		'ÑÐ°Ð·':'раз',
		//now we have tried our best
		'Ð°':'а',
		'Ð±':'б',
		'Ð²':'в',
		'Ð³':'г',
		'Ð´':'д',
		'Ðµ':'е',
		'Ñ‘':'ё',
		'Ð¶':'ж',
		'Ð·':'з',
		'Ð¸':'и',
		'Ð¹':'й',
		'Ðº':'к',
		'Ð»':'л',
		'Ð¼':'м',
		'Ð½':'н',
		'Ð¾':'о',
		'Ð¿':'п',
		'Ñ€':'р',
		'Ñƒ':'у',
		'Ñ„':'ф',
		'Ñ…':'х',
		'Ñ†':'ц',
		'Ñ‡':'ч',
		'Ñˆ':'ш',
		'Ñ‰':'щ',
		'ÑŠ':'ъ',
		'Ñ‹':'ы',
		'ÑŒ':'ь',
		'ÑŽ':'ю',
		'Ñ‚':'т',
		'Ñ':'с',
		'Ñ':'э',
		'Ñ':'я',
		'Ð':'А',
		'Ð‘':'Б',
		'Ð’':'В',
		'Ð“':'Г',
		'Ð”':'Д',
		'Ð•':'Е',
		'Ð':'Ё',
		'Ð–':'Ж',
		'Ð—':'З',
		'Ð˜':'И',
		'Ð™':'Й',
		'Ðš':'К',
		'Ð›':'Л',
		'Ðœ':'М',
		'Ðž':'О',
		'ÐŸ':'П',
		'Ð ':'Р',
		'Ð¡':'С',
		'Ð¢':'Т',
		'Ð£':'У',
		'Ð¤':'Ф',
		'Ð¥':'Х',
		'Ð¦':'Ц',
		'Ð§':'Ч',
		'Ð¨':'Ш',
		'Ð©':'Щ',
		'Ðª':'Ъ',
		'Ð«':'Ы',
		'Ð¬':'Ь',
		'Ð­':'Э',
		'Ð®':'Ю',
		'Ð¯':'Я',
		'Ð':'Н',
		// added by crimaniak
		'Ñ':'ч',
		'Ñ':'т',
		'\x8F':','
		},
	run: function()
	{
		var table=this.table;
		d3.xpath.each("//body//text()[contains(string(),'Ð')]",function(node)
			{
				if(node.data==undefined) return; // Opera fix
				var txt=node.data;
				for(var i in table) txt=txt.split(i).join(table[i]);
				node.data=txt;
			});
	}
});
